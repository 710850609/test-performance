-- for mysql
-- 说明： 生成随机身份证号码，依赖函数rand_date()。
--  根据《中华人民共和国国家标准GB 11643-1999》中有关公民身份号码的规定，公民身份号码是特征组合码，由十七位数字本体码和一位数字校验码组成。
--  排列顺序从左至右依次为：六位数字地址码，八位数字出生日期码，三位数字顺序码和一位数字校验码。
--  顺序码的奇数分给男性，偶数分给女性。校验码是根据前面十七位数字码，按照ISO 7064:1983.MOD 11-2校验码计算出来的检验码。
-- 使用说明： select rand_idcard_no(); -- 输出 340802201403318145

delimiter $$
CREATE FUNCTION `rand_idcard_no`() RETURNS varchar(18) CHARSET utf8  NO SQL
begin
    -- 全国地区编码
    SET @area_code = '110113,120223,130403,130425,130433,130731,131000,131023,131024,131081,140106,140222,140226,140227,140524,140600,140828,140922,140981,141129,141130,150426,150525,150727,152525,210201,210300,210801,211101,220103,220182,220203,220323,220500,220821,222400,230108,230307,230703,230710,230833,231003,231222,231223,231281,232721,232722,320201,320302,320503,320584,320724,320831,320902,320982,321003,321081,321181,321201,330000,330108,330122,330183,330205,330225,330411,330600,330723,340103,340207,340301,340603,340802,341221,341421,341521,341822,350206,350427,350526,350721,360421,360425,360428,370105,370611,370685,370687,370883,370900,370921,371311,371422,371424,410302,410782,411081,411421,420607,420800,420900,430102,430122,430225,430301,430401,430511,430624,430922,431027,431127,431201,440306,440703,440923,441400,441821,441827,441882,445321,450100,450224,450521,450701,450923,450981,451022,451029,451421,451424,460200,500232,500237,510106,510112,510183,510503,510601,510683,510903,511524,511602,511823,513224,513229,513328,520300,520326,522422,522633,522700,530103,530501,530702,532600,532622,533324,542100,542125,542227,542322,542331,542421,542424,542525,542626,610301,610429,610528,610702,610901,610926,620524,620901,621124,621201,621226,623026,632126,632523,632821,652300,652901,653000,653022,653121,653123,653128,653200,654021,';

    -- 产生随机前6位号码（地区码）
    SET @tmp_area_size = length(@area_code) / 7;
    SET @tmp_area_code = substring(@area_code, ceil(rand() * @tmp_area_size) * 7 + 1, 6);
    -- 产生随机中间8位号码（出生日期， 这里可以修改出生日期）
    SET @tmp_birthday = rand_date(str_to_date('1990-01-01', '%Y-%m-%d'), str_to_date('2019-01-01', '%Y-%m-%d'));
    SET @tmp_mid = date_format(@tmp_birthday, '%Y%m%d');
    -- 产生随机后面4位号码
    SET @tmp_last = substring('0123456789', ceil(rand() * 10), 1);
    SET @tmp_last = concat(@tmp_last, substring('0123456789', ceil(rand() * 10), 1));
    SET @tmp_last = concat(@tmp_last, substring('0123456789', ceil(rand() * 10), 1));
    SET @tmp_last = concat(@tmp_last, substring('0123456789X', ceil(rand() * 11), 1));
    RETURN concat(@tmp_area_code, @tmp_mid, @tmp_last);
end $$